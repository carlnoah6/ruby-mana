<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ruby-mana ğŸ”® â€” Embed LLM as Native Ruby</title>
  <meta name="description" content="Write natural language in Ruby that reads and writes variables, calls functions, and controls program flow. LLM as a first-class language construct.">
  <style>
    :root {
      --bg: #0d1117;
      --surface: #161b22;
      --border: #30363d;
      --text: #e6edf3;
      --text-dim: #8b949e;
      --accent: #a371f7;
      --accent2: #f778ba;
      --accent3: #79c0ff;
      --code-bg: #0d1117;
      --green: #3fb950;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
      overflow-x: hidden;
    }

    .container { max-width: 900px; margin: 0 auto; padding: 0 24px; }

    /* Hero */
    .hero {
      text-align: center;
      padding: 80px 0 60px;
      position: relative;
    }

    .hero::before {
      content: '';
      position: absolute;
      top: -200px;
      left: 50%;
      transform: translateX(-50%);
      width: 600px;
      height: 600px;
      background: radial-gradient(circle, rgba(163,113,247,0.15) 0%, transparent 70%);
      pointer-events: none;
    }

    .hero h1 {
      font-size: 3.5rem;
      font-weight: 800;
      letter-spacing: -0.03em;
      margin-bottom: 16px;
    }

    .hero h1 .emoji { font-size: 3rem; }
    .hero h1 .mana { color: var(--accent); }

    .hero .tagline {
      font-size: 1.25rem;
      color: var(--text-dim);
      max-width: 500px;
      margin: 0 auto 40px;
    }

    .hero-code {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 24px 32px;
      text-align: left;
      display: inline-block;
      max-width: 600px;
      width: 100%;
      font-size: 0.95rem;
    }

    /* Install bar */
    .install {
      display: flex;
      justify-content: center;
      gap: 12px;
      margin-top: 32px;
      flex-wrap: wrap;
    }

    .install code {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 10px 20px;
      font-family: 'SF Mono', 'Fira Code', monospace;
      font-size: 0.9rem;
      color: var(--green);
    }

    .btn {
      display: inline-block;
      padding: 10px 24px;
      border-radius: 8px;
      text-decoration: none;
      font-weight: 600;
      font-size: 0.9rem;
      transition: all 0.2s;
    }

    .btn-primary {
      background: var(--accent);
      color: #fff;
    }

    .btn-primary:hover { opacity: 0.85; }

    .btn-secondary {
      background: var(--surface);
      color: var(--text);
      border: 1px solid var(--border);
    }

    .btn-secondary:hover { border-color: var(--accent); }

    /* Sections */
    section {
      padding: 60px 0;
      border-top: 1px solid var(--border);
    }

    section h2 {
      font-size: 1.8rem;
      font-weight: 700;
      margin-bottom: 12px;
      letter-spacing: -0.02em;
    }

    section h2 .dim { color: var(--text-dim); font-weight: 400; }

    section p.lead {
      color: var(--text-dim);
      font-size: 1.05rem;
      margin-bottom: 32px;
      max-width: 600px;
    }

    /* Code blocks */
    pre {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 20px 24px;
      overflow-x: auto;
      margin-bottom: 24px;
      font-size: 0.88rem;
      line-height: 1.7;
    }

    code {
      font-family: 'SF Mono', 'Fira Code', 'Cascadia Code', monospace;
    }

    .code-label {
      font-size: 0.75rem;
      color: var(--text-dim);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 8px;
    }

    /* Syntax colors */
    .kw { color: #ff7b72; }
    .str { color: #a5d6ff; }
    .mana-str { color: #f0abfc; background: rgba(163,113,247,0.1); border-radius: 3px; padding: 0 2px; }
    .cmt { color: #8b949e; font-style: italic; }
    .num { color: #79c0ff; }
    .fn { color: #d2a8ff; }
    .var { color: #ffa657; }
    .sym { color: #7ee787; }
    .op { color: #ff7b72; }

    /* Feature grid */
    .features {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 32px;
    }

    .feature {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 24px;
    }

    .feature .icon { font-size: 1.5rem; margin-bottom: 8px; }
    .feature h3 { font-size: 1rem; margin-bottom: 6px; }
    .feature p { color: var(--text-dim); font-size: 0.88rem; }

    /* How it works */
    .steps {
      display: flex;
      flex-direction: column;
      gap: 16px;
      margin-top: 24px;
    }

    .step {
      display: flex;
      gap: 16px;
      align-items: flex-start;
    }

    .step-num {
      flex-shrink: 0;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: var(--accent);
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 0.85rem;
    }

    .step-text { padding-top: 4px; }
    .step-text strong { color: var(--text); }
    .step-text span { color: var(--text-dim); font-size: 0.9rem; }

    /* Comparison */
    .comparison {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-top: 24px;
    }

    .comparison > div {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 20px;
    }

    .comparison h3 {
      font-size: 0.85rem;
      color: var(--text-dim);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 12px;
    }

    .comparison pre {
      margin: 0;
      border: none;
      background: var(--code-bg);
      font-size: 0.82rem;
    }

    /* Footer */
    footer {
      padding: 40px 0;
      border-top: 1px solid var(--border);
      text-align: center;
      color: var(--text-dim);
      font-size: 0.85rem;
    }

    footer a { color: var(--accent); text-decoration: none; }
    footer a:hover { text-decoration: underline; }

    /* Responsive */
    @media (max-width: 640px) {
      .hero h1 { font-size: 2.2rem; }
      .hero .tagline { font-size: 1rem; }
      .comparison { grid-template-columns: 1fr; }
      .hero-code { padding: 16px 20px; font-size: 0.85rem; }
    }
  </style>
</head>
<body>

<div class="container">
  <!-- Hero -->
  <div class="hero">
    <h1><span class="mana">ruby-mana</span> <span class="emoji">ğŸ”®</span></h1>
    <p class="tagline">Embed LLM as native Ruby. Write natural language, it just runs.</p>

    <div class="hero-code">
<pre style="margin:0;border:none;padding:0;background:none;"><span class="kw">require</span> <span class="str">"mana"</span>

numbers = [<span class="num">1</span>, <span class="str">"2"</span>, <span class="str">"three"</span>, <span class="str">"cuatro"</span>, <span class="str">"äº”"</span>]
<span class="mana-str">~"compute the semantic average of &lt;numbers&gt; and store in &lt;result&gt;"</span>
<span class="fn">puts</span> result  <span class="cmt"># =&gt; 3.0</span></pre>
    </div>

    <div class="install">
      <code>gem install ruby-mana</code>
      <a href="https://github.com/carlnoah6/ruby-mana" class="btn btn-primary">GitHub â†’</a>
      <a href="https://rubygems.org/gems/ruby-mana" class="btn btn-secondary">RubyGems</a>
    </div>
  </div>

  <!-- What makes it different -->
  <section>
    <h2>Not a wrapper. <span class="dim">A language construct.</span></h2>
    <p class="lead">Most LLM libraries give you an API client. Mana gives you a new kind of string â€” one that executes.</p>

    <div class="features">
      <div class="feature">
        <div class="icon">ğŸ”—</div>
        <h3>Bidirectional binding</h3>
        <p>LLM reads and writes your Ruby variables directly. No serialization, no parsing output.</p>
      </div>
      <div class="feature">
        <div class="icon">ğŸ”„</div>
        <h3>Loops & function calls</h3>
        <p>LLM can iterate over collections and call your Ruby methods â€” with real return values.</p>
      </div>
      <div class="feature">
        <div class="icon">âœ¨</div>
        <h3>Minimal syntax</h3>
        <p><code>~"..."</code> in any .rb file. Natural language that just runs.</p>
      </div>
      <div class="feature">
        <div class="icon">ğŸ§¬</div>
        <h3>Effect system</h3>
        <p>Built on algebraic effects â€” Fiber-based handler loop with tool-use protocol.</p>
      </div>
      <div class="feature">
        <div class="icon">ğŸ¯</div>
        <h3>Object manipulation</h3>
        <p>Read attributes, write attributes, work with any Ruby object â€” Structs, classes, OpenStruct.</p>
      </div>
      <div class="feature">
        <div class="icon">ğŸŒ</div>
        <h3>Multilingual</h3>
        <p>Prompts work in any language. Write Chinese, English, Spanish â€” the LLM understands.</p>
      </div>
    </div>
  </section>

  <!-- Examples -->
  <section>
    <h2>See it in action</h2>

    <div class="code-label">Object manipulation</div>
<pre><span class="kw">class</span> <span class="fn">Email</span>
  <span class="fn">attr_accessor</span> <span class="sym">:subject</span>, <span class="sym">:body</span>, <span class="sym">:category</span>, <span class="sym">:priority</span>
<span class="kw">end</span>

email = <span class="fn">Email</span>.<span class="fn">new</span>
email.subject = <span class="str">"URGENT: Server down"</span>
email.body = <span class="str">"Database connection pool exhausted..."</span>

<span class="mana-str">~"read &lt;email&gt; subject and body, set category and priority"</span>

<span class="fn">puts</span> email.category  <span class="cmt"># =&gt; "urgent"</span>
<span class="fn">puts</span> email.priority  <span class="cmt"># =&gt; "high"</span></pre>

    <div class="code-label">Loops & function calls</div>
<pre><span class="kw">def</span> <span class="fn">fetch_price</span>(symbol)
  { <span class="str">"AAPL"</span> =&gt; <span class="num">189.5</span>, <span class="str">"GOOG"</span> =&gt; <span class="num">141.2</span>, <span class="str">"TSLA"</span> =&gt; <span class="num">248.9</span> }[symbol] || <span class="num">0</span>
<span class="kw">end</span>

<span class="kw">def</span> <span class="fn">send_alert</span>(msg)
  <span class="fn">puts</span> <span class="str">"[ALERT] </span>#{msg}<span class="str">"</span>
<span class="kw">end</span>

portfolio = [<span class="str">"AAPL"</span>, <span class="str">"GOOG"</span>, <span class="str">"TSLA"</span>, <span class="str">"MSFT"</span>]

<span class="mana-str">~"iterate &lt;portfolio&gt;, call fetch_price for each, send_alert if price &gt; 200, store the sum in &lt;total&gt;"</span>
<span class="fn">puts</span> total  <span class="cmt"># =&gt; 579.6</span></pre>

    <div class="code-label">Mixed control flow â€” Ruby structure, LLM decisions</div>
<pre>player_hp = <span class="num">100</span>
enemy_hp = <span class="num">80</span>
inventory = [<span class="str">"sword"</span>, <span class="str">"potion"</span>, <span class="str">"shield"</span>]

<span class="kw">while</span> player_hp &gt; <span class="num">0</span> &amp;&amp; enemy_hp &gt; <span class="num">0</span>
  <span class="mana-str">~"player HP=&lt;player_hp&gt;, enemy HP=&lt;enemy_hp&gt;, inventory=&lt;inventory&gt;, choose an action and store in &lt;action&gt;"</span>

  <span class="kw">case</span> action
  <span class="kw">when</span> <span class="str">"attack"</span> <span class="kw">then</span> enemy_hp -= <span class="fn">rand</span>(<span class="num">15</span>..<span class="num">25</span>)
  <span class="kw">when</span> <span class="str">"defend"</span> <span class="kw">then</span> <span class="kw">nil</span>
  <span class="kw">when</span> <span class="str">"use_item"</span>
    <span class="mana-str">~"pick a healing item from &lt;inventory&gt; and store in &lt;item_name&gt;"</span>
    inventory.delete(item_name)
    player_hp += <span class="num">25</span>
  <span class="kw">end</span>
<span class="kw">end</span></pre>
  </section>

  <!-- How it works -->
  <section>
    <h2>How it works</h2>
    <p class="lead">Mana uses an effect system â€” a Fiber-based handler loop with LLM tool-use protocol.</p>

    <div class="steps">
      <div class="step">
        <div class="step-num">1</div>
        <div class="step-text">
          <strong>Capture</strong><br>
          <span><code>~"..."</code> calls <code>String#~@</code>, which captures the caller's <code>Binding</code> via <code>binding_of_caller</code></span>
        </div>
      </div>
      <div class="step">
        <div class="step-num">2</div>
        <div class="step-text">
          <strong>Parse</strong><br>
          <span>Engine extracts <code>&lt;var&gt;</code> references and reads existing variables as context</span>
        </div>
      </div>
      <div class="step">
        <div class="step-num">3</div>
        <div class="step-text">
          <strong>Execute</strong><br>
          <span>Prompt + context sent to LLM with tools: <code>read_var</code>, <code>write_var</code>, <code>read_attr</code>, <code>write_attr</code>, <code>call_func</code>, <code>done</code></span>
        </div>
      </div>
      <div class="step">
        <div class="step-num">4</div>
        <div class="step-text">
          <strong>Loop</strong><br>
          <span>LLM responds with tool calls â†’ Mana executes against live Ruby binding â†’ sends results back â†’ repeat until <code>done</code></span>
        </div>
      </div>
    </div>
  </section>

  <!-- Comparison -->
  <section>
    <h2>Mana vs. the rest</h2>
    <p class="lead">Existing Ruby LLM libraries are API wrappers. Mana is a language extension.</p>

    <div class="comparison">
      <div>
        <h3>Typical LLM gem</h3>
<pre style="border:none;margin:0;background:none;">client = LLM::Client.new
response = client.chat(
  "Classify this email: #{email}"
)
category = JSON.parse(response)["category"]
email.category = category</pre>
      </div>
      <div style="border-color: var(--accent);">
        <h3>ruby-mana</h3>
<pre style="border:none;margin:0;background:none;"><span class="mana-str">~"read &lt;email&gt; subject and body, set category"</span>

<span class="cmt"># That's it. email.category is set.</span></pre>
      </div>
    </div>
  </section>

  <!-- Research -->
  <section>
    <h2>Research</h2>
    <p class="lead">Mana is inspired by MIT's Nightjar project and the theory of algebraic effects.</p>
    <p style="color: var(--text-dim); font-size: 0.9rem; line-height: 1.8;">
      ğŸ“„ <a href="https://arxiv.org/abs/2512.14805" style="color: var(--accent3);">Sharing State Between Prompts and Programs</a> â€” the paper that started it all<br>
      ğŸ <a href="https://github.com/psg-mit/nightjarpy" style="color: var(--accent3);">nightjarpy</a> â€” MIT's Python implementation<br>
      ğŸ’ ruby-mana â€” the Ruby implementation, with <code>~"..."</code> syntax and effect system
    </p>
  </section>

  <!-- Footer -->
  <footer>
    <p>
      <a href="https://github.com/carlnoah6/ruby-mana">GitHub</a> Â·
      <a href="https://rubygems.org/gems/ruby-mana">RubyGems</a> Â·
      MIT License
    </p>
    <p style="margin-top: 8px;">Ruby 3.3+ Â· Anthropic Claude</p>
  </footer>
</div>

</body>
</html>
